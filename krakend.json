{
   "version": 3,
   "port": 8080,
   "extra_config":{
      "telemetry/logging": {
         "level": "DEBUG",
         "prefix": "[KRAKEND]",
         "syslog": false,
         "stdout": true,
         "format": "default"
      },
      "telemetry/opentelemetry": {
         "service_name": "storage.apigw",
         "trace_sample_rate": {{ env "OTEL_SAMPLE_RATE" | default (1) }},
         "exporters": {
            "otlp": [
               {
                  "name": "telemetry.collector",
                  "host": {{ env "OTEL_EXPORTER_OTLP_URL" | default ("collector.telemetry.internal") | quote }},
                  "port": {{ env "OTEL_EXPORTER_OTLP_PORT" | default ("4318") | int64 }},
                  "use_http": {{ env "OTEL_USE_HTTP" | default ("true") | eq "true" }},
                  "disable_metrics": {{ env "OTEL_DISABLE_METRICS" | default ("false") | eq "true" }}
               }
            ]
         },
	 "layers": {
	    "backend": {
	       "traces": {
	          "report_headers": true
	       }
	    },
	    "global": {
	      "report_headers": true
	    }
	 }
      },
      "security/cors": {
         "allow_origins":[
            "http*"
         ],
         "allow_headers":[
            "*"
         ],
         "allow_methods":[
            "GET",
            "POST",
            "PUT",
            "PATCH",
            "DELETE",
            "OPTIONS"
         ]
      }
   },
   "timeout": "5m",
   "cache_ttl": "300s",
   "name": "API Gateway",
   "endpoints": [
     {{ template "storage_v1.tmpl" . }},
     {{ template "storage.tmpl" . }}
   ]
}
